// --------------------------------------------------------
// Code generated by Papyrus C++
// --------------------------------------------------------

#ifndef STATEMACHINE_EVENTPRIORITYQUEUE_H
#define STATEMACHINE_EVENTPRIORITYQUEUE_H

/************************************************************
 EventPriorityQueue class header
 ************************************************************/

#include "statemachine/Pkg_statemachine.h"

#include "AnsiCLibrary/Pkg_AnsiCLibrary.h"
#include "pthread.h"
#include "statemachine/Event_t.h"

// Include from Include stereotype (header)
#include "pthread.h"
#include "stdio.h"
#include "string.h"

#define SINGLETON_QUEUE_SIZE (200)
#define defSize (10)
#if defined (SINGLETON_QUEUE_SIZE)
#undef SINGLETON_QUEUE_SIZE
#endif
#define SINGLETON_QUEUE_SIZE (500)

// End of Include stereotype (header)

namespace statemachine {

/************************************************************/
/**
 * 
 */
class EventPriorityQueue {
public:
	/**
	 * 
	 */
	static Event_t SINGLETON_QUEUE[SINGLETON_QUEUE_SIZE];
	/**
	 * 
	 */
	static unsigned int singleton_counter;
	/**
	 * 
	 */
	EventPriorityQueue();
	/**
	 * 
	 * @param priority 
	 * @param data 
	 * @param eventID 
	 * @param eventType 
	 * @param associatedState 
	 * @param dataSize 
	 */
	void push(EventPriority_t /*in*/priority, void* /*in*/data,
			unsigned int /*in*/eventID, EventType_t /*in*/eventType,
			unsigned int /*in*/associatedState, int /*in*/dataSize = 0);
	/**
	 * 
	 * @return ret 
	 * @param popDeferred 
	 */
	Event_t* pop(bool /*in*/popDeferred = false);
	/**
	 * 
	 * @param defe 
	 */
	void saveDeferred(Event_t& /*in*/defe);
	/**
	 * 
	 * @param desired_size 
	 */
	void allocate_queue(unsigned int /*in*/desired_size);
	/**
	 * 
	 * @return ret 
	 */
	unsigned int getCompletionSize();

private:
	/**
	 * 
	 */
	Event_t* data;
	/**
	 * 
	 */
	unsigned int size;
	/**
	 * 
	 */
	unsigned int numberOfElements;
	/**
	 * 
	 */
	unsigned int readPos;
	/**
	 * 
	 */
	unsigned int writePos;
	/**
	 * 
	 */
	pthread_mutex_t mutex;
	/**
	 * 
	 */
	pthread_cond_t cond;
	/**
	 * 
	 */
	Event_t completionEvents[4];
	/**
	 * 
	 */
	unsigned int compSize;
	/**
	 * 
	 */
	unsigned int compNumbers;
	/**
	 * 
	 */
	unsigned int compReadPos;
	/**
	 * 
	 */
	unsigned int compWritePos;
	/**
	 * 
	 */
	Event_t deferreds[defSize];
	/**
	 * 
	 */
	unsigned int numberOfDeferreds;
	/**
	 * 
	 */
	unsigned int readDef;
	/**
	 * 
	 */
	unsigned int writeDef;
	/**
	 * 
	 */
	void heapify();
};
/************************************************************/
/* External declarations (package visibility)               */
/************************************************************/

/* Inline functions                                         */

} // of namespace statemachine

/************************************************************
 End of EventPriorityQueue class header
 ************************************************************/

#endif
